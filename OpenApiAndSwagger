Microsoft.AspNetCore.OpenApi ve Swashbuckle.AspNetCore NuGet'leri indirilir.

using Microsoft.AspNetCore.OpenApi;
using Swashbuckle.AspNetCore;

if (app.Environment.IsDevelopment())
{
    app.UseSwagger();
    app.UseSwaggerUI();
}
Ã–RNEK ROUTE => /swagger >> https://localhost:7043/swagger

if (app.Environment.IsDevelopment())
Bu koÅŸul, uygulamanÄ±n Ã§alÄ±ÅŸma ortamÄ±nÄ±n (environment) Development olup olmadÄ±ÄŸÄ±nÄ± kontrol eder.
ASP.NET Core uygulamalarÄ±nda Ã§alÄ±ÅŸma ortamÄ± (Development, Staging, Production) ASPNETCORE_ENVIRONMENT ortam deÄŸiÅŸkeniyle belirlenir.
Bu sayede, sadece geliÅŸtirme aÅŸamasÄ±nda bazÄ± Ã¶zellikleri aktif edebilirsin.
Ã–rnek: dotnet run ile Ã§alÄ±ÅŸÄ±rken Development modunda olur, sunucuya yÃ¼kleyince genelde Production olur.

app.UseSwagger()
Bu middleware, uygulamanÄ±n OpenAPI/Swagger JSON dÃ¶kÃ¼mantasyonunu saÄŸlayan endpointâ€™i aktif eder.
VarsayÄ±lan olarak /swagger/v1/swagger.json adresinde eriÅŸilebilir.
Bu JSON, Swagger UIâ€™nin kullanacaÄŸÄ± ham API tanÄ±mÄ±dÄ±r.

app.UseSwaggerUI()
Swagger UIâ€™yi (gÃ¶rsel arayÃ¼z) aktif eder.
Bu arayÃ¼z sayesinde tarayÄ±cÄ±dan API endpointâ€™lerini test edebilir, dÃ¶nen sonuÃ§larÄ± gÃ¶rebilirsin.
VarsayÄ±lan olarak /swagger adresinden ulaÅŸÄ±lÄ±r.


app.MapGet("/blogs/{id}", (int id) =>
{
    if (id >= 1 && id <= blogs.Count)
    {
        return Results.Ok(blogs[id - 1]);
    }
    else
    {
        return Results.NotFound(); //throw new ArgumentOutOfRangeException(nameof(id), "Blog not found");
    }
    }).WithOpenApi(operation =>
    {
        operation.Parameters[0].Description = "The ID of the blog to retrieve";
        operation.Summary = "Get a specific blog by ID";
        operation.Description = "Returns a single blog"; 
        return operation;
    });

WithOpenApi(...) Nedir?
Bu minimal API fonksiyonu, OpenAPI (Swagger) dokÃ¼mantasyonunu Ã¶zelleÅŸtirmeni saÄŸlar.
Yani endpointâ€™in Swagger UI Ã¼zerinde nasÄ±l gÃ¶rÃ¼neceÄŸini deÄŸiÅŸtirebilirsin.
Ä°Ã§ine verdiÄŸin lambda (operation => { ... }) kÄ±smÄ±, OpenApiOperation nesnesini alÄ±r.

operation Neyi Temsil Ediyor?
operation, OpenAPI spesifikasyonundaki Operation Objectâ€™i temsil eder.
Bu nesne, tek bir API endpointâ€™inin:
Parametrelerini
AÃ§Ä±klamasÄ±nÄ±
Ã–zetini
Geri dÃ¶nÃ¼ÅŸ tiplerini vb. iÃ§erir.
Swagger UI Ã¼zerinde gÃ¶rdÃ¼ÄŸÃ¼n her endpointâ€™in arkasÄ±nda bÃ¶yle bir operation nesnesi vardÄ±r.

operation.Parameters[0].Description
Bu, endpointâ€™in ilk parametresine (burada {id}) aÃ§Ä±klama ekler.
Swagger UIâ€™de â€œParametersâ€ bÃ¶lÃ¼mÃ¼nde gÃ¶rÃ¼necek.
Burada "The ID of the blog to retrieve" ÅŸeklinde aÃ§Ä±klama verilmiÅŸ.

operation.Summary
Endpointâ€™in kÄ±sa aÃ§Ä±klamasÄ±.
Swagger UIâ€™de endpoint baÅŸlÄ±ÄŸÄ±nda gÃ¶rÃ¼nÃ¼r.
Burada "Get a specific blog by ID" olarak ayarlanmÄ±ÅŸ.

operation.Description
Endpointâ€™in uzun aÃ§Ä±klamasÄ±.
Swagger UIâ€™de endpointâ€™in altÄ±ndaki detay kÄ±smÄ±nda gÃ¶rÃ¼nÃ¼r.
Burada "Returns a single blog" ÅŸeklinde verilmiÅŸ.

4ï¸âƒ£ MantÄ±k AkÄ±ÅŸÄ±
MapGet â†’ /blogs/{id} endpointâ€™ini tanÄ±mlar.
WithOpenApi(...) â†’ Swagger dokÃ¼mantasyonunu Ã¶zelleÅŸtirir.
operation â†’ Bu endpointâ€™in OpenAPI iÃ§indeki tanÄ±m nesnesidir.
Ä°Ã§eride parametre aÃ§Ä±klamasÄ±, kÄ±sa Ã¶zet ve detay aÃ§Ä±klama eklenir.
return operation; â†’ Ã–zelleÅŸtirilmiÅŸ operation geri dÃ¶ner ve Swagger bunu kullanÄ±r.

ğŸ“Œ Ã–zet:
operation burada Swagger/OpenAPI dokÃ¼manÄ±nda bu endpointâ€™in nasÄ±l gÃ¶rÃ¼neceÄŸini tanÄ±mlayan nesnedir.
Sen bu nesne Ã¼zerinde aÃ§Ä±klama (Description), kÄ±sa baÅŸlÄ±k (Summary), parametre aÃ§Ä±klamalarÄ± gibi bilgileri deÄŸiÅŸtirerek dokÃ¼mantasyonu geliÅŸtiriyorsun.

**KOD**
using Microsoft.AspNetCore.Http.HttpResults;
using Microsoft.AspNetCore.OpenApi;
using Swashbuckle.AspNetCore;

var builder = WebApplication.CreateBuilder(args);

builder.Services.AddEndpointsApiExplorer();  // Endpoints API keÅŸfini etkinleÅŸtiriyoruz. Bu, API'nizin uÃ§ noktalarÄ±nÄ± keÅŸfetmek iÃ§in kullanÄ±lÄ±r.
builder.Services.AddSwaggerGen();            // Swagger'Ä± ekliyoruz. Bu, API'nizin dokÃ¼mantasyonunu oluÅŸturmak iÃ§in kullanÄ±lÄ±r.

var app = builder.Build();

var blogs = new List<Blog>
{
    new Blog { Title = "First Blog", Body = "This is the body of the first blog." },
    new Blog { Title = "Second Blog", Body = "This is the body of the second blog." },
};

if (app.Environment.IsDevelopment())
{
    app.UseSwagger();   // Swagger'Ä± geliÅŸtirme ortamÄ±nda kullanÄ±yoruz. Bu, API'nizin dokÃ¼mantasyonunu oluÅŸturmak iÃ§in kullanÄ±lÄ±r.
    app.UseSwaggerUI(); // Swagger UI'yi etkinleÅŸtiriyoruz. Bu, API'nizin dokÃ¼mantasyonunu gÃ¶rsel olarak gÃ¶rÃ¼ntÃ¼lemek iÃ§in kullanÄ±lÄ±r.
}

app.MapGet("/", () => "Hello World!").ExcludeFromDescription(); // OpenApi dokÃ¼mantasyonundan hariÃ§ tutmak iÃ§in kullanÄ±lÄ±r.


app.MapGet("/blogs", () =>
{
return blogs;
});

// Get a specific blog by ID, 
app.MapGet("/blogs/{id}", Results<Ok<Blog>, NotFound>(int id) => //Buradaki amaÃ§, OpenAPI dokÃ¼mantasyonunda bu endpoint'in hem baÅŸarÄ±lÄ± hem de baÅŸarÄ±sÄ±z durumlarÄ±nÄ± gÃ¶sterebilmek iÃ§indir.
{
    if (id >= 1 && id <= blogs.Count)
    {
        return TypedResults.Ok(blogs[id - 1]); // ID'ler 1'den baÅŸladÄ±ÄŸÄ± iÃ§in, liste indeksini 1 azaltÄ±yoruz. Ve TypedResults.Ok() ile baÅŸarÄ±lÄ± sonucu dÃ¶ndÃ¼rÃ¼yoruz.
    }                                          // TypedResults.Ok() metodu, OpenAPI dokÃ¼mantasyonunda baÅŸarÄ±lÄ± bir yanÄ±tÄ± temsil eder.
    else                                       // TypedResults genel olarak, OpenAPI dokÃ¼mantasyonunda daha iyi bir deneyim sunmak iÃ§in kullanÄ±lÄ±r.
    {
        return TypedResults.NotFound(); 
    }
    }).WithOpenApi(operation =>
    {
        operation.Parameters[0].Description = "The ID of the blog to retrieve"; // OpenAPI dokÃ¼mantasyonunda parametre aÃ§Ä±klamasÄ± eklemek iÃ§in kullanÄ±lÄ±r.
        operation.Summary = "Get a specific blog by ID";                        // OpenAPI dokÃ¼mantasyonunda Ã¶zet aÃ§Ä±klama eklemek iÃ§in kullanÄ±lÄ±r.
        operation.Description = "Returns a single blog";                        // OpenAPI dokÃ¼mantasyonunda detaylÄ± aÃ§Ä±klama eklemek iÃ§in kullanÄ±lÄ±r.
        return operation;
    });

//Create a new blog
app.MapPost("/blogs", (Blog blog) => {
blogs.Add(blog);
return Results.Created($"/blogs/{blogs.Count - 1}", blog);
});

//Delete a blog
app.MapDelete("/blogs/{id}", (int id) => {
if (id >= 1 && id <= blogs.Count)
{
blogs.RemoveAt(id - 1);
return Results.NoContent(); //204 No Content? HTTP 204 durumu, bir isteÄŸin (genelde PUT, DELETE) baÅŸarÄ±yla iÅŸlendiÄŸini fakat sunucunun dÃ¶ndÃ¼recek iÃ§eriÄŸi olmadÄ±ÄŸÄ±nÄ± belirtir.
}
else
{
return Results.NotFound(); //throw new ArgumentOutOfRangeException(nameof(id), "Blog not found");
}
});

//Update a blog
app.MapPut("/blogs/{id}", (int id, Blog blog) =>
{
if (id >= 1 && id <= blogs.Count)
{
blogs[id - 1] = blog; // Update the blog at the specified index
return Results.Ok($"Updated: {blog}");
}
else
{
return Results.NotFound(); //throw new ArgumentOutOfRangeException(nameof(id), "Blog not found");
}
});

app.Run();

public class Blog
{
    public required string Title { get; set; }
    public required string Body { get; set; }
}
