API nedir, ne iÅŸe yarar?
API, farklÄ± yazÄ±lÄ±m uygulamalarÄ±nÄ±n veya sistemlerin birbirleriyle iletiÅŸim kurmasÄ±nÄ± saÄŸlayan bir arayÃ¼zdÃ¼r. Yani, bir programÄ±n baÅŸka bir programla "konuÅŸmasÄ±nÄ±" mÃ¼mkÃ¼n kÄ±lar.

Minimal API, ASP.NET Coreâ€™da, Controller sÄ±nÄ±flarÄ±, Startup.cs, IActionResult, routing attributes gibi yapÄ±lar olmadan doÄŸrudan Program.cs dosyasÄ±nda basit ve sade bir biÃ§imde HTTP endpointâ€™leri tanÄ±mlamana olanak tanÄ±yan bir yaklaÅŸÄ±mdÄ±r.
"Minimal kod, maksimum iÅŸ" felsefesiyle REST API'leri oluÅŸturmanÄ± saÄŸlar.

| Ã–zellik                               | AÃ§Ä±klama                                     |
| ------------------------------------- | -------------------------------------------- |
| ğŸ”¸ Basit yapÄ±                         | Sadece `Program.cs` yeterli                  |
| ğŸ”¸ HÄ±zlÄ± baÅŸlangÄ±Ã§                    | Controller, Startup, Service yapÄ±sÄ± gerekmez |
| ğŸ”¸ Performans odaklÄ±                  | Gereksiz abstraction yoktur, daha hÄ±zlÄ±dÄ±r   |
| ğŸ”¸ GeliÅŸtirici dostu                  | Az satÄ±rla Ã§ok iÅŸ yapÄ±lÄ±r                    |
| ğŸ”¸ Test ve kÃ¼Ã§Ã¼k servisler iÃ§in ideal | Mikro servis yapÄ±larÄ± iÃ§in uygundur          |

Ã–rnek MinimalApi
var builder = WebApplication.CreateBuilder(args);
var app = builder.Build();

app.MapGet("/", () => "Hello World!");
app.MapGet("/hello", () => "Merhaba!");
app.MapGet("/square/{number}", (int number) => number * number);

app.Run();

| Klasik ASP.NET Core                   | Minimal API                    |
| ------------------------------------- | ------------------------------ |
| Controller sÄ±nÄ±flarÄ± gerekir          | Gerekmez                       |
| `[HttpGet]`, `[Route]` vs kullanÄ±lÄ±r  | `MapGet`, `MapPost` kullanÄ±lÄ±r |
| Startup.cs / ConfigureServices vardÄ±r | Gerekmez                       |
| Daha fazla boilerplate kod            | Daha az, sade yapÄ±             |



Basit Ã¶rnekle aÃ§Ä±klamak gerekirse:
Diyelim bir hava durumu uygulamasÄ± var. Bu uygulama, hava durumu verilerini dÄ±ÅŸarÄ±dan bir kaynaktan (mesela bir hava durumu servisi) almak ister.
API, bu uygulamanÄ±n dÄ±ÅŸ servisle iletiÅŸim kurmasÄ± iÃ§in belirlenmiÅŸ kurallar ve protokoller setidir.
Uygulama API aracÄ±lÄ±ÄŸÄ±yla servisden gÃ¼ncel hava durumu verisini ister, servis de uygun formatta yanÄ±t verir.

APIâ€™nin temel Ã¶zellikleri:
Veri alÄ±ÅŸveriÅŸi: Uygulamalar arasÄ± veri gÃ¶nderip alma iÅŸlemini kolaylaÅŸtÄ±rÄ±r.
Standart iletiÅŸim: Ä°ki sistemin nasÄ±l konuÅŸacaÄŸÄ±nÄ±, hangi verileri nasÄ±l isteyeceÄŸini ve cevaplayacaÄŸÄ±nÄ± belirler.
Soyutlama: API kullanÄ±cÄ±larÄ±, sistemin iÃ§ detaylarÄ±nÄ± bilmeden iÅŸlevleri kullanabilir.
Tekrarlanabilirlik: APIâ€™ler standart olduÄŸu iÃ§in birÃ§ok uygulama tarafÄ±ndan tekrar tekrar kullanÄ±labilir.

Web API Nedir?
Web API, farklÄ± uygulamalarÄ±n veya sistemlerin internet Ã¼zerinden HTTP protokolÃ¼ aracÄ±lÄ±ÄŸÄ±yla veri alÄ±ÅŸveriÅŸi yapmasÄ±nÄ± saÄŸlayan arayÃ¼zdÃ¼r.
HTTP: Web tarayÄ±cÄ±larÄ±nÄ±n ve sunucularÄ±n kullandÄ±ÄŸÄ± iletiÅŸim protokolÃ¼dÃ¼r. (GET, POST, PUT, DELETE gibi metotlarÄ± vardÄ±r.)
Web API, bu protokolÃ¼ kullanarak, bir uygulamanÄ±n baÅŸka bir uygulamaya veri gÃ¶ndermesini veya ondan veri almasÄ±nÄ± saÄŸlar.

Web APIâ€™nin Temel Ã–zellikleri:
Ä°nternet Ã¼zerinde Ã§alÄ±ÅŸÄ±r.
Genellikle REST veya SOAP gibi standart mimariler kullanÄ±r.
Veri formatÄ± olarak genellikle JSON veya XML kullanÄ±lÄ±r.
Platform baÄŸÄ±msÄ±zdÄ±r; farklÄ± programlama dilleri ve sistemler tarafÄ±ndan kullanÄ±labilir.

RESTâ€™in Temel KavramlarÄ±
Kaynak (Resource):
Ä°nternet Ã¼zerindeki her ÅŸey bir "kaynak" olarak dÃ¼ÅŸÃ¼nÃ¼lebilir. Ã–rneÄŸin; kullanÄ±cÄ±lar, Ã¼rÃ¼nler, mesajlar, sipariÅŸler birer kaynaktÄ±r.
Her kaynaÄŸÄ±n benzersiz bir URI (Uniform Resource Identifier) adresi vardÄ±r. Ã–rnek: https://api.example.com/users/123
HTTP MetodlarÄ±:
REST API, HTTP protokolÃ¼ndeki metodlarÄ± kullanarak kaynaklar Ã¼zerinde iÅŸlem yapar.
En sÄ±k kullanÄ±lan metodlar:

GET: Veri sorgulamak (veri Ã§ekmek) iÃ§in
POST: Yeni veri oluÅŸturmak iÃ§in
PUT: Var olan veriyi gÃ¼ncellemek iÃ§in
DELETE: Veriyi silmek iÃ§in
PATCH: Var olan verinin bir kÄ±smÄ±nÄ± gÃ¼ncellemek iÃ§in

Stateless (Durumsuzluk):
REST API, sunucunun her isteÄŸi baÄŸÄ±msÄ±z ve Ã¶ncekilerden baÄŸÄ±msÄ±z olarak ele aldÄ±ÄŸÄ± bir mimaridir.
Yani, sunucu istemcinin Ã¶nceki isteklerine dair bilgiyi saklamaz. Her istek kendi iÃ§inde gerekli tÃ¼m bilgiyi taÅŸÄ±r.

Temsiller (Representations):
Kaynaklar farklÄ± formatlarda temsil edilebilir; en yaygÄ±nlarÄ± JSON ve XMLâ€™dir.
API genellikle JSON formatÄ±nda veri gÃ¶nderir ve alÄ±r Ã§Ã¼nkÃ¼ JSON hafiftir ve Ã§oÄŸu programlama dili tarafÄ±ndan kolay iÅŸlenir.

URI yapÄ±sÄ±:
Kaynaklar hiyerarÅŸik ve mantÄ±klÄ± URI yapÄ±larÄ± ile tanÄ±mlanÄ±r. Ã–rneÄŸin:
/users â†’ TÃ¼m kullanÄ±cÄ±lar
/users/5 â†’ ID'si 5 olan kullanÄ±cÄ±
/users/5/orders â†’ 5 numaralÄ± kullanÄ±cÄ±nÄ±n sipariÅŸleri

| HTTP Metodu | Ä°ÅŸlem                               | URI Ã–rneÄŸi   | AÃ§Ä±klama                                |
| ----------- | ----------------------------------- | ------------ | --------------------------------------- |
| GET         | Veri alma                           | /products    | TÃ¼m Ã¼rÃ¼nleri listeler                   |
| GET         | Belirli veri alma                   | /products/10 | ID'si 10 olan Ã¼rÃ¼nÃ¼ getirir             |
| POST        | Yeni veri oluÅŸturma                 | /products    | Yeni Ã¼rÃ¼n ekler                         |
| PUT         | Var olan veriyi tamamen gÃ¼ncelleme  | /products/10 | ID 10 olan Ã¼rÃ¼nÃ¼ tamamen deÄŸiÅŸtirir     |
| PATCH       | Var olan verinin kÄ±smÄ±nÄ± gÃ¼ncelleme | /products/10 | ID 10 Ã¼rÃ¼nÃ¼n bazÄ± alanlarÄ±nÄ± deÄŸiÅŸtirir |
| DELETE      | Veri silme                          | /products/10 | ID 10 Ã¼rÃ¼nÃ¼ siler                       |

RESTful API TasarÄ±mÄ±nda Ä°yi Pratikler
Ä°simlendirme: Kaynak isimleri Ã§oÄŸul kullanÄ±lÄ±r (/users, /orders).

HTTP durum kodlarÄ±: Ä°steklerin sonucunu belirtmek iÃ§in doÄŸru HTTP kodlarÄ± kullanÄ±lÄ±r.
Ã–rnekler:

200 OK â†’ BaÅŸarÄ±lÄ± GET isteÄŸi
201 Created â†’ BaÅŸarÄ±lÄ± POST ile veri oluÅŸturuldu
204 No Content â†’ BaÅŸarÄ±lÄ± DELETE iÅŸlemi
400 Bad Request â†’ Ä°stek hatalÄ±
404 Not Found â†’ Kaynak bulunamadÄ±
500 Internal Server Error â†’ Sunucu hatasÄ±

Versiyonlama: API geliÅŸtirirken sÃ¼rÃ¼m yÃ¶netimi Ã¶nemlidir. URIâ€™da veya headerâ€™da versiyon belirtilir. Ã–rnek: /api/v1/users

Filtreleme, sÄ±ralama ve sayfalama: BÃ¼yÃ¼k veri setlerinde APIâ€™nin performansÄ± ve kullanÄ±labilirliÄŸi iÃ§in desteklenir.
Ã–rnek: /products?category=electronics&sort=price_asc&page=2

RESTful API NasÄ±l Ã‡alÄ±ÅŸÄ±r? Basit AkÄ±ÅŸ
Ä°stemci (client), bir HTTP isteÄŸi gÃ¶nderir (Ã¶rneÄŸin, GET /users).
Sunucu, isteÄŸi alÄ±r ve ilgili kaynaÄŸÄ± iÅŸler.
Sunucu, isteÄŸe karÅŸÄ±lÄ±k JSON formatÄ±nda veri dÃ¶ner.
Ä°stemci dÃ¶nen veriyi iÅŸler ve kullanÄ±cÄ±ya gÃ¶sterir.

Ã–rnek JSON YanÄ±tÄ±
GET /users/5 isteÄŸine gelen Ã¶rnek cevap:

{
  "id": 5,
  "name": "Atalay Ã–zcan",
  "email": "atalay.ozcan@example.com",
  "createdAt": "2025-07-28T12:00:00Z"
}


Route Templates (Yol ÅablonlarÄ±) Nedir?
Web uygulamalarÄ±nda, Ã¶zellikle RESTful API veya MVC (Model-View-Controller) yapÄ±larÄ±nda, gelen HTTP isteklerinin hangi kod bloÄŸuna yÃ¶nlendirileceÄŸini belirleyen URL kalÄ±plarÄ±dÄ±r.
Yani, URL yapÄ±sÄ± nasÄ±l olacak ve URL iÃ§indeki hangi parÃ§alar (segmentler) hangi verilere karÅŸÄ±lÄ±k gelecek, onu tanÄ±mlayan yapÄ±dÄ±r.

Route Templatesâ€™in Alt BaÅŸlÄ±klarÄ±
1. Route Parameters (Yol Parametreleri)
URL iÃ§erisinde deÄŸiÅŸken parÃ§alardÄ±r.
Bu parametreler, URL'deki belirli bir bÃ¶lÃ¼mÃ¼ temsil eder ve deÄŸer olarak dinamik bilgi alÄ±r.
Genellikle {parametreAdi} ÅŸeklinde tanÄ±mlanÄ±r. 
Ã–rnek: /products/{id}
Burada id bir parametredir.
Ä°stek /products/5 ise, id = 5 olarak alÄ±nÄ±r.
Bu sayede farklÄ± Ã¼rÃ¼nlerin detaylarÄ± aynÄ± route ÅŸablonuyla alÄ±nabilir.

2. Optional Parameters (Opsiyonel Parametreler)
BazÄ± parametrelerin zorunlu deÄŸil, isteÄŸe baÄŸlÄ± olmasÄ±nÄ± saÄŸlar.
Parametre adÄ±nÄ±n sonuna ? iÅŸareti konur.
Ã–rnek:/products/{id?}
Burada id parametresi isteÄŸe baÄŸlÄ±dÄ±r.
/products/5 veya sadece /products istekleri her ikisi de geÃ§erli olur.
Kodda, id parametresi boÅŸ (null) olabilir ve buna gÃ¶re iÅŸlem yapÄ±labilir.

Constraints (KÄ±sÄ±tlamalar)
Parametrelerin alabileceÄŸi deÄŸerleri sÄ±nÄ±rlamak iÃ§in kullanÄ±lÄ±r.
Parametrenin sadece belirli tÃ¼rde veya formattaki deÄŸerleri kabul etmesini saÄŸlar.
Route template iÃ§inde sÃ¼slÃ¼ parantez iÃ§ine : ile kÄ±sÄ±tlama eklenir.

YaygÄ±n kullanÄ±lan constraint Ã¶rnekleri:
| Constraint  | AÃ§Ä±klama                     | Ã–rnek                    |
| ----------- | ---------------------------- | ------------------------ |
| `int`       | Sadece tam sayÄ± kabul eder   | `{id:int}`               |
| `bool`      | Sadece boolean deÄŸer         | `{flag:bool}`            |
| `datetime`  | Tarih formatÄ±nda olmalÄ±      | `{date:datetime}`        |
| `length(3)` | En fazla 3 karakter          | `{code:length(3)}`       |
| `regex()`   | DÃ¼zenli ifadeye uygun olmalÄ± | `{name:regex(^[a-z]+$)}` |

Ã–zet
| Kavram              | TanÄ±m                                                   | Ã–rnek URL            | AÃ§Ä±klama                           |
| ------------------- | ------------------------------------------------------- | -------------------- | ---------------------------------- |
| Route Parameters    | URLâ€™de dinamik veri olarak kullanÄ±lan deÄŸiÅŸken parÃ§alar | `/users/{userId}`    | `userId` deÄŸeri URLâ€™den alÄ±nÄ±r     |
| Optional Parameters | Zorunlu olmayan parametreler                            | `/users/{userId?}`   | `userId` olabilir veya olmayabilir |
| Constraints         | Parametrelerin deÄŸer tipini/formunu sÄ±nÄ±rlayan kural    | `/products/{id:int}` | `id` sadece tam sayÄ± olmalÄ±        |

//Basic Route
app.MapGet("/users/{userId}/posts/{slug}", (int userId, string slug) =>
{
    return $"User ID: {userId}, Post Slug: {slug}";
});

//Constrained Route Parameters
app.MapGet("/products/{id:int:min(1):max(100)}", (int id) =>
{
   return $"Product ID: {id}";
});

//Optional Route Parameters
app.MapGet("/reports/{year?}", (int? year = 2016) =>
{
    return $"Report of the year: {year}";
});

Catch-All Routes (TÃ¼rkÃ§esi: Yakalama RotalarÄ± veya TÃ¼mÃ¼nÃ¼ Yakalama RotalarÄ±), web uygulamalarÄ±nda veya API yÃ¶nlendirmelerinde, 
gelen istek URL'sinin belirli bir kalÄ±ba uymayan veya Ã¶nceden tanÄ±mlanmamÄ±ÅŸ tÃ¼m yollarÄ± yakalamak iÃ§in kullanÄ±lan Ã¶zel bir rota tÃ¼rÃ¼dÃ¼r.

Catch-All Route Nedir?
Gelen URLâ€™de belirtilen ÅŸablona uymayan tÃ¼m URLâ€™leri yakalayan route (yol) ÅŸablonudur.
Genellikle daha esnek ve geniÅŸ kapsamlÄ± yÃ¶nlendirme iÃ§in kullanÄ±lÄ±r.
Ã–zellikle 404 sayfasÄ± (sayfa bulunamadÄ±) veya dinamik iÃ§erik yÃ¼kleme gibi durumlarda faydalÄ±dÄ±r.

NasÄ±l Ã‡alÄ±ÅŸÄ±r?
Normalde routeâ€™lar spesifik ve belirli kalÄ±plara baÄŸlÄ±dÄ±r.
Catch-All route, URLâ€™nin kalan tÃ¼m kÄ±sÄ±mlarÄ±nÄ± tek bir parametre olarak alÄ±r.
Bu parametre sayesinde URLâ€™nin geri kalan kÄ±smÄ± string olarak elde edilir.

Ã–rnek (ASP.NET Coreâ€™da):
// Route template: catch-all parametresi **
[Route("files/{*filepath}")]
public IActionResult GetFile(string filepath)
{
    // filepath parametresi URL'nin files sonrasÄ± tÃ¼m kÄ±smÄ±nÄ± iÃ§erir
    return Content("Ä°stenen dosya yolu: " + filepath);
}
/files/images/photo.jpg isteÄŸi geldiÄŸinde:
filepath = "images/photo.jpg" olur.

/files/docs/report.pdf isteÄŸi geldiÄŸinde:
filepath = "docs/report.pdf" olur.

Neden KullanÄ±lÄ±r?
Dinamik sayfa veya iÃ§erik yÃ¼kleme (CMS uygulamalarÄ± gibi)
Statik dosyalar veya klasÃ¶r yapÄ±larÄ± iÃ§in esnek eriÅŸim
TÃ¼m bilinmeyen URLâ€™leri Ã¶zel olarak yÃ¶netmek (404 sayfalarÄ± iÃ§in)
URL parametrelerini toplu almak

| Terim           | AnlamÄ±                                                         |
| --------------- | -------------------------------------------------------------- |
| Catch-All Route | URLâ€™nin kalan tÃ¼m kÄ±smÄ±nÄ± tek parametreyle yakalayan rota tipi |
| KullanÄ±m AlanÄ±  | Dosya yollarÄ±, dinamik iÃ§erik, 404 sayfa yÃ¶netimi              |

//Catch-all Route Parameter
app.MapGet("/files/{*filePath}", (string filePath) =>
{
    return $"Requested file path: {filePath}";
});

Query Parameters Nedir?
Query Parameters (Sorgu Parametreleri), bir HTTP isteÄŸinde URL'nin sonunda, genellikle veri filtrelemek, sÄ±ralamak, arama yapmak veya sayfalama gibi iÅŸlemler iÃ§in kullanÄ±lan anahtar-deÄŸer Ã§iftleridir.

YapÄ± (SÃ¶z Dizimi):
https://example.com/products?category=electronics&sort=price_asc
Bu URLâ€™de:
? â†’ Sorgu parametrelerinin baÅŸladÄ±ÄŸÄ±nÄ± gÃ¶sterir.
category=electronics â†’ category adÄ±nda bir parametre, deÄŸeri electronics
& â†’ Birden fazla parametre arasÄ±nda ayraÃ§ olarak kullanÄ±lÄ±r.
sort=price_asc â†’ sort adÄ±nda baÅŸka bir parametre, deÄŸeri price_asc

| KullanÄ±m AlanÄ±          | AÃ§Ä±klama                                    |
| ----------------------- | ------------------------------------------- |
| ğŸ” Arama                | `?q=telefon` â†’ "telefon" kelimesiyle ara    |
| ğŸ—‚ï¸ Filtreleme          | `?category=books` â†’ Sadece kitaplarÄ± gÃ¶ster |
| ğŸ”ƒ SÄ±ralama             | `?sort=price_desc` â†’ FiyatÄ±na gÃ¶re sÄ±rala   |
| ğŸ“„ Sayfalama            | `?page=2&limit=10` â†’ 2. sayfa, 10 Ã¼rÃ¼n      |
| ğŸ”§ Ayarlar / seÃ§enekler | `?showDetails=true` â†’ DetaylarÄ± gÃ¶ster      |

 Ã–rnek URL ve AnlamÄ±:
https://api.example.com/users?age=30&sort=name_desc&page=2
AnlamÄ±:
age=30 â†’ 30 yaÅŸÄ±ndaki kullanÄ±cÄ±larÄ± getir
sort=name_desc â†’ Ä°sme gÃ¶re azalan sÄ±rala
page=2 â†’ Ä°kinci sayfadaki sonuÃ§larÄ± gÃ¶ster

Ã–zetle:
Query Parameters, URLâ€™ye ? ile eklenen, veri alma isteklerinde filtreleme, arama, sÄ±ralama ve sayfalama gibi iÅŸlemleri kontrol etmemizi saÄŸlayan anahtar-deÄŸer Ã§iftleridir. 
Uygulamalarda API endpointâ€™lerine esneklik ve detaylÄ± sorgu gÃ¼cÃ¼ kazandÄ±rÄ±r.

//Route with Query Parameters
app.MapGet("/search", (string? q, int page = 1) =>
{                                                              https://localhost:7053/search?q=dotnet&page=2
    return $"Searching for {q} on page {page}";
});  
**Path kÄ±smÄ±nda boÅŸluk bÄ±rakmamaya Ã¶zen gÃ¶stermeli hata almadÄ±m fakat 404 Ã§evirdi o yÃ¼zden path iÃ§inde space yapÄ±lmamalÄ±!


CRUD API'S

The main code: 
var builder = WebApplication.CreateBuilder(args);
var app = builder.Build();

var blogs = new List<Blog>
{
    new Blog { Title = "First Blog", Body = "This is the body of the first blog." },
    new Blog { Title = "Second Blog", Body = "This is the body of the second blog." }
};

app.MapGet("/", () => "Hello World!");

app.MapGet("/blogs", () =>
{
    return blogs;
});

app.Run();

public class Blog
{
    public required string Title { get; set; }
    public required string Body { get; set; }
}

READ CRUDE (GET)
app.MapGet("/blogs/{id}", (int id) =>
{
    if(id >= 1 && id <= blogs.Count)
    {
        return Results.Ok(blogs[id - 1]);
    }
    else
    {
        return Results.NotFound(); //throw new ArgumentOutOfRangeException(nameof(id), "Blog not found");
    }
});

CREATE CRUDE (POST)
//Create a new blog
app.MapPost("/blogs", (Blog blog) =>{ List nesnesi oluÅŸturuyoruz, Ã§Ã¼nkÃ¼ listeye yeni eleman eklememiz lazÄ±m. Results.Created() ASP.NET Core Minimal APIâ€™de HTTP 201 Created yanÄ±tÄ± dÃ¶ndÃ¼rmek iÃ§in kullanÄ±lan bir yardÄ±mcÄ± metottur.
    blogs.Add(blog);
    return Results.Created($"/blogs/{blogs.Count -1}", blog);
});

DELETE CRUDE (DELETE)
app.MapDelete("/blogs/{id}", (int id) => {
    if(id >= 1 && id <= blogs.Count)
    {
        blogs.RemoveAt(id -1 );
        return Results.NoContent(); //204 No Content? HTTP 204 durumu, bir isteÄŸin (genelde PUT, DELETE) baÅŸarÄ±yla iÅŸlendiÄŸini fakat sunucunun dÃ¶ndÃ¼recek iÃ§eriÄŸi olmadÄ±ÄŸÄ±nÄ± belirtir.
    }
    else    
    {
        return Results.NotFound(); //throw new ArgumentOutOfRangeException(nameof(id), "Blog not found");
    }
});

UPDATE CRUDE (PUT)
//Update a blog
app.MapPut("/blogs/{id}", (int id, Blog blog) =>
{
    if (id >= 1 && id <= blogs.Count)
    {
        blogs[id - 1] = blog; // Update the blog at the specified index
        return Results.Ok($"Updated: {blog}");
    }
    else
    {
        return Results.NotFound(); //throw new ArgumentOutOfRangeException(nameof(id), "Blog not found");
    }
});
